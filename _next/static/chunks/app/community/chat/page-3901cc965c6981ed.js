(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1484],{14811:function(e,t,r){Promise.resolve().then(r.bind(r,42507))},42507:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return x}});var s=r(57437),a=r(2265),n=r(47267),i=r(36013),o=r(50495),l=r(83102),d=r(94880),c=r(41647),u=r(11240),f=r(74453),m=r(60994),p=r(35657),h=r(6649);function x(){var e,t,r;let[x,g]=(0,a.useState)(""),[v,y]=(0,a.useState)(""),[b,N]=(0,a.useState)([]),[j,w]=(0,a.useState)([]),{toast:S}=(0,p.pm)(),{user:E,authenticated:T}=(0,h.s)();(0,a.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/chat/rooms"),t=await e.json();N(t),t.length>0&&!x&&g(t[0].id)}catch(e){console.error("Error fetching chat rooms:",e),S({title:"Error",description:"Failed to load chat rooms",variant:"destructive"})}})()},[]),(0,a.useEffect)(()=>{if(!x)return;let e=async()=>{try{let e=await fetch("/api/chat?roomId=".concat(x)),t=await e.json();w(t)}catch(e){console.error("Error fetching messages:",e),S({title:"Error",description:"Failed to load messages",variant:"destructive"})}};e();let t=setInterval(e,3e3);return()=>clearInterval(t)},[x]);let C=async()=>{if(!T){S({title:"Authentication Required",description:"Please sign in to send messages",variant:"destructive"});return}if(v.trim())try{if(!(await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(null==E?void 0:E.token)},body:JSON.stringify({roomId:x,content:v.trim()})})).ok)throw Error("Failed to send message");y("")}catch(e){console.error("Error sending message:",e),S({title:"Error",description:"Failed to send message",variant:"destructive"})}},k=async e=>{if(!T){S({title:"Authentication Required",description:"Please sign in to join chat rooms",variant:"destructive"});return}try{let t=await fetch("/api/chat/rooms",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(null==E?void 0:E.token)},body:JSON.stringify({roomId:e})});if(!t.ok){let r=await t.json();if("Already a member of this room"===r.error){g(e);return}throw Error(r.error||"Failed to join room")}g(e),S({title:"Success",description:"Joined chat room successfully"})}catch(e){console.error("Error joining room:",e),S({title:"Error",description:"Failed to join chat room",variant:"destructive"})}};return(0,s.jsxs)("div",{className:"container mx-auto py-8 px-4 max-w-7xl mt-16",children:[(0,s.jsxs)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"mb-8",children:[(0,s.jsx)("h1",{className:"text-4xl font-bold tracking-tight bg-gradient-to-r from-primary to-primary/60 bg-clip-text text-transparent",children:"Community Chat"}),(0,s.jsx)("p",{className:"text-muted-foreground mt-2",children:"Connect in real-time with others in the community"})]}),(0,s.jsxs)("div",{className:"grid gap-6 md:grid-cols-4",children:[(0,s.jsxs)(i.Zb,{className:"md:col-span-1 border-none shadow-md bg-card/50 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:[(0,s.jsxs)(i.Ol,{children:[(0,s.jsxs)(i.ll,{className:"flex items-center gap-2",children:[(0,s.jsx)(u.Z,{className:"w-5 h-5 text-primary"}),"Chat Rooms"]}),(0,s.jsx)(i.SZ,{children:"Join a conversation"})]}),(0,s.jsx)(i.aY,{children:(0,s.jsx)("div",{className:"space-y-2",children:b.map(e=>(0,s.jsxs)(o.z,{variant:x===e.id?"default":"ghost",className:"w-full justify-start gap-2",onClick:()=>k(e.id),children:[(0,s.jsx)("span",{className:"text-xl",children:e.icon}),(0,s.jsxs)("div",{className:"flex flex-col items-start",children:[(0,s.jsx)("span",{children:e.name}),(0,s.jsxs)("span",{className:"text-xs text-muted-foreground",children:[e.memberCount," online"]})]}),e.isPrivate&&(0,s.jsx)(f.Z,{className:"w-4 h-4 ml-auto text-muted-foreground"})]},e.id))})})]}),(0,s.jsxs)(i.Zb,{className:"md:col-span-3 border-none shadow-md bg-card/50 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:[(0,s.jsxs)(i.Ol,{children:[(0,s.jsxs)(i.ll,{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"text-xl",children:null===(e=b.find(e=>e.id===x))||void 0===e?void 0:e.icon}),null===(t=b.find(e=>e.id===x))||void 0===t?void 0:t.name]}),(0,s.jsx)(i.SZ,{children:null===(r=b.find(e=>e.id===x))||void 0===r?void 0:r.description})]}),(0,s.jsx)(i.aY,{children:(0,s.jsxs)("div",{className:"flex flex-col h-[600px]",children:[(0,s.jsx)(d.x,{className:"flex-1 pr-4",children:(0,s.jsx)("div",{className:"space-y-4",children:j.map(e=>(0,s.jsxs)("div",{className:"flex items-start gap-3 group",children:[(0,s.jsx)(c.qE,{children:(0,s.jsx)(c.Q5,{children:e.userId[0]})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"font-semibold",children:e.userId}),(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:new Date(e.createdAt).toLocaleTimeString()})]}),(0,s.jsx)("p",{className:"text-sm mt-1",children:e.content})]})]},e.id))})}),(0,s.jsxs)("div",{className:"mt-4 flex gap-2",children:[(0,s.jsx)(l.I,{placeholder:"Type your message...",value:v,onChange:e=>y(e.target.value),onKeyPress:e=>"Enter"===e.key&&C(),className:"flex-1"}),(0,s.jsxs)(o.z,{onClick:C,disabled:!T||!v.trim(),className:"gap-2",children:[(0,s.jsx)(m.Z,{className:"w-4 h-4"}),"Send"]})]})]})})]})]})]})}},41647:function(e,t,r){"use strict";r.d(t,{F$:function(){return l},Q5:function(){return d},qE:function(){return o}});var s=r(57437),a=r(2265),n=r(44458),i=r(37440);let o=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(n.fC,{ref:t,className:(0,i.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",r),...a})});o.displayName=n.fC.displayName;let l=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(n.Ee,{ref:t,className:(0,i.cn)("aspect-square h-full w-full",r),...a})});l.displayName=n.Ee.displayName;let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(n.NY,{ref:t,className:(0,i.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",r),...a})});d.displayName=n.NY.displayName},50495:function(e,t,r){"use strict";r.d(t,{z:function(){return d}});var s=r(57437),a=r(2265),n=r(71538),i=r(13027),o=r(37440);let l=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),d=a.forwardRef((e,t)=>{let{className:r,variant:a,size:i,asChild:d=!1,...c}=e,u=d?n.g7:"button";return(0,s.jsx)(u,{className:(0,o.cn)(l({variant:a,size:i,className:r})),ref:t,...c})});d.displayName="Button"},36013:function(e,t,r){"use strict";r.d(t,{Ol:function(){return o},SZ:function(){return d},Zb:function(){return i},aY:function(){return c},ll:function(){return l}});var s=r(57437),a=r(2265),n=r(37440);let i=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...a})});i.displayName="Card";let o=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",r),...a})});o.displayName="CardHeader";let l=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("h3",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",r),...a})});l.displayName="CardTitle";let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",r),...a})});d.displayName="CardDescription";let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",r),...a})});c.displayName="CardContent",a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",r),...a})}).displayName="CardFooter"},83102:function(e,t,r){"use strict";r.d(t,{I:function(){return i}});var s=r(57437),a=r(2265),n=r(37440);let i=a.forwardRef((e,t)=>{let{className:r,type:a,...i}=e;return(0,s.jsx)("input",{type:a,className:(0,n.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...i})});i.displayName="Input"},94880:function(e,t,r){"use strict";r.d(t,{x:function(){return o}});var s=r(57437),a=r(2265),n=r(62125),i=r(37440);let o=a.forwardRef((e,t)=>{let{className:r,children:a,...o}=e;return(0,s.jsxs)(n.fC,{ref:t,className:(0,i.cn)("relative overflow-hidden",r),...o,children:[(0,s.jsx)(n.l_,{className:"h-full w-full rounded-[inherit]",children:a}),(0,s.jsx)(l,{}),(0,s.jsx)(n.Ns,{})]})});o.displayName=n.fC.displayName;let l=a.forwardRef((e,t)=>{let{className:r,orientation:a="vertical",...o}=e;return(0,s.jsx)(n.gb,{ref:t,orientation:a,className:(0,i.cn)("flex touch-none select-none transition-colors","vertical"===a&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===a&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",r),...o,children:(0,s.jsx)(n.q4,{className:"relative flex-1 rounded-full bg-border"})})});l.displayName=n.gb.displayName},35657:function(e,t,r){"use strict";r.d(t,{pm:function(){return f}});var s=r(2265);let a=0,n=new Map,i=e=>{if(n.has(e))return;let t=setTimeout(()=>{n.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);n.set(e,t)},o=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?i(r):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},l=[],d={toasts:[]};function c(e){d=o(d,e),l.forEach(e=>{e(d)})}function u(e){let{...t}=e,r=(a=(a+1)%Number.MAX_VALUE).toString(),s=()=>c({type:"DISMISS_TOAST",toastId:r});return c({type:"ADD_TOAST",toast:{...t,id:r,open:!0,onOpenChange:e=>{e||s()}}}),{id:r,dismiss:s,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:r}})}}function f(){let[e,t]=s.useState(d);return s.useEffect(()=>(l.push(t),()=>{let e=l.indexOf(t);e>-1&&l.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},37440:function(e,t,r){"use strict";r.d(t,{cn:function(){return n}});var s=r(44839),a=r(96164);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.m6)((0,s.W)(t))}}},function(e){e.O(0,[8502,6649,7267,2125,313,2971,7023,1744],function(){return e(e.s=14811)}),_N_E=e.O()}]);